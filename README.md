# Malina — Backend

**Данные:** PostgreSQL 15+, Redis, MinIO/S3 (медиа).

**Контракты:** OpenAPI 3.0, Protobuf.

**Инфра/CI:** Docker, Docker Compose/Helm/Kubernetes, Github CI/CD.

**Наблюдаемость:** Prometheus, Grafana, Loki.

**Безопасность:** JWT/OAuth2, rate‑limits, Trivy, Snyk.

## Архитектура модулей

- `auth` — регистрация/логин (e‑mail/телефон, соц‑логин), JWT, refresh‑токены.
- `profile` — анкеты, фото, интересы, гео.
- `match` — лайки/дизлайки, фильтры, взаимные совпадения.
- `chat` — 1:1 сообщения, WS‑подключения, доставлен/прочитан.
- `moderation` — жалобы, бан/мьют, репутация.
- `admin` — админ‑API (роли, статистика, модерация).

## Роли и сценарии использования

**Гость**: регистрация, просмотр маркетинговых страниц.

**Пользователь**: управление профилем, загрузка фото, лайк/дизлайк, просмотр совпадений, переписка.

**Верифицированный пользователь**: повышенные лимиты/видимость.

**Модератор**: обработка жалоб, блокировки, скрытие контента.

**Администратор**: управление ролями, конфигурацией, метриками.

### Примеры сценариев

- Пользователь настраивает профиль → получает ленту кандидатов → ставит лайк → при взаимности создаётся матч → начинается чат.
- Пользователь отправляет жалобу → модератор рассматривает → применяет санкции.

## Схема БД

![Database Schema](docs/erg.png)

## API

Находится в файле [api-spec.yaml](api-spec.yaml)
